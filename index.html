<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SLAP | Teste de N√≠vel de Ingl√™s</title>
    <!-- Favicon da SLAP -->
    <link rel="icon" type="image/png" href="https://res.cloudinary.com/dqfi22uz0/image/upload/v1749543469/SLAP_FAVICON_AMARELO_coilvj.png">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: DM Sans -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* Aplicando a fonte padr√£o e cores do Hub Pedag√≥gico */
        html, body {
            /* Garante que o body n√£o tem scroll horizontal indesejado e usa a altura total */
            height: 100%;
            overflow-x: hidden;
            transition: background-color 0.4s ease; /* Adiciona transi√ß√£o para a mudan√ßa de cor de fundo */
        }
        body {
            font-family: 'DM Sans', sans-serif;
            display: flex;
            flex-direction: column;
            /* Cor de fundo padr√£o (ser√° sobrescrita pelo JS/classes) */
            background-color: #1c1917; /* stone-900 (Fundo inicial escuro) */
            color: #f5f5f4; /* stone-100 (Cor inicial do texto) */
            /* Controla o scroll vertical, s√≥ aparece se o conte√∫do for maior que o viewport */
            overflow-y: auto; 
        }

        /* Classes din√¢micas para mudar o fundo no JS */
        .bg-dark { background-color: #1c1917; color: #f5f5f4; }
        .bg-yellow { background-color: #F1D24B; color: #44403c; }
        .bg-white-quiz { background-color: white; color: #44403c; }
        
        /* Otimiza a rolagem de ecr√£ para evitar barras duplas e scroll desnecess√°rio */
        main {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh; /* Garante que o main centraliza o conte√∫do verticalmente */
            padding: 1rem 1rem; /* Reduz padding vertical base para o mobile */
            width: 100%;
        }

        /* Estilos base para todas as "telas" agora que o cont√™iner foi removido */
        .screen-view {
            width: 100%; 
            max-width: 48rem; /* Limita a largura do conte√∫do para desktop */
            text-align: center;
            padding: 1.5rem 0;
            height: auto;
        }

        /* Estilos espec√≠ficos para Ecr√£s de Apresenta√ß√£o Escuros - agora sem fundo pr√≥prio */
        .dark-splash {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        /* Estilos do Quiz reutilizados do Hub */
        .quiz-option {
            display: block;
            width: 100%;
            padding: 0.75rem 1rem;
            margin-bottom: 0.75rem;
            text-align: left;
            background-color: #f5f5f4; /* stone-100 */
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }
        .quiz-option:hover:not(:disabled) {
            background-color: #FFFBEB; /* yellow-50 */
            border-color: #F1D24B;
        }
        .quiz-option:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }
        .quiz-option.correct {
            background-color: #D1FAE5; /* green-200 */
            border-color: #34D399; /* green-400 */
            color: #065F46; /* green-800 */
            font-weight: 700;
        }
        .quiz-option.incorrect {
            background-color: #FEE2E2; /* red-200 */
            border-color: #F87171; /* red-400 */
            color: #991B1B; /* red-800 */
            font-weight: 700;
        }
        .quiz-feedback {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            font-size: 0.875rem;
            line-height: 1.5;
        }
        .quiz-feedback.correct {
            background-color: #ECFDF5; /* green-50 */
            color: #059669; /* green-600 */
        }
        .quiz-feedback.incorrect {
            background-color: #FEF2F2; /* red-50 */
            color: #DC2626; /* red-600 */
        }
        .quiz-feedback strong {
            font-weight: 700;
        }
        .action-button {
             background-color: #F1D24B; 
             color: #44403c; /* stone-800 */
             border: none; 
             padding: 0.75rem 1.5rem; 
             border-radius: 9999px; 
             font-weight: 700; 
             cursor: pointer; 
             transition: background-color 0.2s, transform 0.2s;
             display: inline-flex;
             align-items: center;
             gap: 0.5rem;
             text-decoration: none;
        }
        .action-button:hover:not(:disabled) {
            background-color: #eab308; /* Darker yellow */
            transform: translateY(-2px);
        }
        .action-button:disabled {
            background-color: #a8a29e; /* stone-400 */
            cursor: not-allowed;
        }
        .progress-bar-background {
            background-color: #e7e5e4; /* stone-200 */
            border-radius: 9999px;
            height: 1rem;
            width: 100%;
            overflow: hidden;
        }
        .progress-bar-foreground {
            background-color: #F1D24B;
            height: 100%;
            border-radius: 9999px;
            transition: width 0.5s ease-in-out;
        }
        /* Estilos para o campo de input */
        .fill-in-input {
            width: 100%;
            padding: 0.75rem 1rem;
            background-color: #f5f5f4; /* stone-100 */
            border: 2px solid #e7e5e4; /* stone-200 */
            border-radius: 0.5rem;
            font-size: 1rem;
            color: #44403c;
            transition: border-color 0.2s;
        }
        .fill-in-input:focus {
            outline: none;
            border-color: #F1D24B;
        }
        .skip-button {
            background: none;
            border: none;
            color: #a8a29e; /* stone-400 */
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: color 0.2s ease;
        }
        .skip-button:hover:not(:disabled) {
            color: #44403c; /* stone-700 */
        }
        .skip-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        /* Estilo para caixa de aviso */
        .disclaimer-box {
            background-color: #FEFBEB; /* yellow-50 */
            border-left: 4px solid #F1D24B; /* yellow-400 */
            padding: 1rem;
            margin: 1.5rem 0;
            color: #78350F; /* amber-800 */
            font-size: 0.875rem;
            line-height: 1.5;
            text-align: left;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }
        .disclaimer-box svg {
            flex-shrink: 0;
            width: 1.25rem;
            height: 1.25rem;
            margin-top: 0.125rem;
        }
        
        /* Normaliza o tamanho dos inputs para consist√™ncia */
        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="date"] {
          box-sizing: border-box; /* Garante que padding e borda sejam inclu√≠dos na largura total */
        }

    </style>
</head>
<body class="bg-dark text-stone-100">

    <main id="app-container">
        <!-- Cont√™iner principal para centralizar e limitar o conte√∫do no desktop -->
        <div class="w-full max-w-7xl mx-auto">
        
            <!-- SPLASH SCREEN 1: READY QUESTION -->
            <div id="splash-1-view" class="dark-splash screen-view mx-auto md:max-w-xl">
                <!-- √çcone Original (Fundo Amarelo) - rounded-lg ATIVO -->
                <img src="https://res.cloudinary.com/dqfi22uz0/image/upload/v1749349751/DBB440C2-684E-4DCF-9CD3-B2DDC18F1E53_3_vgocga.jpg" alt="SLAP Logo" class="w-32 h-auto mx-auto mb-4 sm:mb-6 rounded-lg">
                <h1 class="text-4xl sm:text-5xl font-bold text-[#F1D24B] mb-4 sm:mb-6">
                    Pronto para descobrir o seu n√≠vel de ingl√™s?
                </h1>
                <button class="action-button bg-[#F1D24B] text-stone-900 text-xl px-12 py-4" onclick="goToSplash2()">
                    Pode mandar!
                </button>
            </div>

            <!-- SPLASH SCREEN 2: DISCLAIMER -->
            <div id="splash-2-view" class="dark-splash screen-view mx-auto md:max-w-xl hidden">
                 <!-- √çcone BRANCO (Fundo Escuro) - rounded-lg REMOVIDO -->
                 <img src="https://res.cloudinary.com/dqfi22uz0/image/upload/v1759294959/SLAP_TIPO_BRANCO_uvynbr.png" alt="SLAP Logo Branco" class="w-32 h-auto mx-auto mb-3 sm:mb-5 opacity-80">
                <p class="text-xl sm:text-2xl font-light leading-relaxed mb-4 sm:mb-6 max-w-lg">
                    Antes de mais nada, a gente do SLAP queria te dizer que este teste n√£o √© uma garantia do seu n√≠vel, hein? üëÄ √â apenas um teste r√°pido!
                    <br><br>
                    E ah, quando voc√™ clicar no bot√£o de come√ßar o teste, vamos pedir apenas alguns dados b√°sicos. Relaxa que n√£o vamos compartilhar com ningu√©m!
                    <br><br>
                    O teste dura, no m√°ximo, 5min. E nem adianta reiniciar pra tirar uma nota boa porque as perguntas n√£o se repetem, t√°?
                </p>
                <button class="action-button bg-stone-100 text-stone-900 text-lg px-10 py-3" onclick="goToForm()">
                    Vamos l√°?
                </button>
            </div>

            <!-- Passo 1: Formul√°rio de Inscri√ß√£o (Fundo Amarelo) -->
            <div id="form-view" class="screen-view hidden flex justify-center w-full mx-auto">
                <!-- Conte√∫do do Formul√°rio -->
                <div class="text-stone-800 p-6 sm:p-8 rounded-xl text-center w-full md:max-w-lg">
                    <!-- √çcone Original (Fundo Amarelo) - rounded-lg ATIVO -->
                    <img src="https://res.cloudinary.com/dqfi22uz0/image/upload/v1749349751/DBB440C2-684E-4DCF-9CD3-B2DDC18F1E53_3_vgocga.jpg" alt="SLAP Logo" class="w-32 h-auto mx-auto mb-4 rounded-lg">
                    <h1 class="text-3xl font-bold text-stone-900">Teste de N√≠vel</h1>
                    <p class="text-stone-700 mt-2 mb-6">Preencha seus dados para iniciar o teste e descobrir seu n√≠vel.</p>
                    <!-- Formspree action √© configurado para receber os dados -->
                    <form id="lead-form" action="https://formspree.io/f/mblyowaq" method="POST" class="text-left space-y-4 max-w-sm mx-auto">
                        <div>
                            <label for="name" class="font-semibold text-stone-800 block mb-1">Nome Completo</label>
                            <input type="text" id="name" name="name" class="w-full px-4 py-2 bg-yellow-50 border-2 border-transparent rounded-lg focus:outline-none focus:border-stone-800 text-stone-900 placeholder-stone-500" required>
                        </div>
                        <div>
                            <label for="email" class="font-semibold text-stone-800 block mb-1">E-mail</label>
                            <input type="email" id="email" name="email" class="w-full px-4 py-2 bg-yellow-50 border-2 border-transparent rounded-lg focus:outline-none focus:border-stone-800 text-stone-900 placeholder-stone-500" required>
                        </div>
                        <div>
                            <label for="whatsapp" class="font-semibold text-stone-800 block mb-1">WhatsApp (com DDD)</label>
                            <input type="tel" id="whatsapp" name="whatsapp" class="w-full px-4 py-2 bg-yellow-50 border-2 border-transparent rounded-lg focus:outline-none focus:border-stone-800 text-stone-900 placeholder-stone-500" placeholder="(XX) XXXXX-XXXX" required>
                        </div>
                        <div class="text-center pt-4">
                            <button id="submit-lead-btn" type="submit" class="action-button w-full sm:w-auto justify-center bg-stone-800 text-white hover:bg-stone-900">
                                Come√ßar o Teste
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Passo 2: O Quiz (Fundo Branco) -->
            <div id="quiz-view" class="screen-view hidden mx-auto md:max-w-3xl">
                 <div class="p-6 sm:p-8 w-full">
                    <!-- Conte√∫do do quiz ser√° injetado aqui pelo JS -->
                 </div>
            </div>

            <!-- Passo 3: Resultado (Fundo Branco) -->
            <div id="result-view" class="screen-view hidden mx-auto md:max-w-3xl">
                <div class="p-8 text-center w-full">
                    <!-- √çcone PRETO (Quiz/Resultado - Fundo Branco) - rounded-lg REMOVIDO -->
                    <img src="https://res.cloudinary.com/dqfi22uz0/image/upload/v1759294967/SLAP_TIPO_PRETO_2_kismg9.png" alt="SLAP Logo Preto" class="w-32 h-auto mx-auto mb-6">
                    <h2 class="text-2xl font-bold mb-2 text-stone-800">Teste Finalizado!</h2>
                    <p id="result-score" class="text-lg text-stone-600 mb-4"></p>
                    <p id="result-time" class="text-xl font-semibold text-stone-700 mb-4"></p>
                    <div class="my-6">
                        <p id="result-level" class="text-3xl font-bold text-[#84C7DF] mb-2"></p>
                        <p id="result-message" class="text-stone-700"></p>
                    </div>

                    <!-- Caixa de Aviso -->
                    <div class="disclaimer-box">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                        </svg>
                        <div>
                            <strong>Aten√ß√£o:</strong> Este teste √© uma pr√©via do seu conhecimento gramatical e de vocabul√°rio. Para ingressar no SLAP, √© necess√°rio um <strong>teste oral</strong> para avaliar sua flu√™ncia e comunica√ß√£o.
                        </div>
                    </div>

                    <!-- Bot√£o CTA -->
                    <div class="text-center mt-8">
                         <a href="https://wa.me/message/VJROWLFO5Z5KF1" target="_blank" class="action-button text-lg px-8 py-3">
                             Quero ser aluno SLAP!
                         </a>
                    </div>

                </div>
            </div>
        </div>
    </main>
    
    <!-- Efeitos Sonoros -->
    <audio id="correct-sound" src="https://res.cloudinary.com/dqfi22uz0/video/upload/v1749377574/correct_pew0xz.mp3" preload="auto"></audio>
    <audio id="wrong-sound" src="https://res.cloudinary.com/dqfi22uz0/video/upload/v1749377575/wrong_hdpg0g.mp3" preload="auto"></audio>

    <script>
        // --- ELEMENTOS DO DOM ---
        const splash1View = document.getElementById('splash-1-view');
        const splash2View = document.getElementById('splash-2-view');
        const formView = document.getElementById('form-view');
        const quizView = document.getElementById('quiz-view');
        const resultView = document.getElementById('result-view');
        const leadForm = document.getElementById('lead-form');
        const correctSound = document.getElementById('correct-sound');
        const wrongSound = document.getElementById('wrong-sound');
        
        // Vari√°veis para armazenar os dados do utilizador
        let studentName = '';
        let studentEmail = '';
        let studentWhatsapp = '';

        // --- Vari√°veis de Tempo ---
        let quizStartTime;
        let timerInterval;
        let totalTimeElapsed = 0; // Armazena o tempo em segundos

        // --- DADOS DO QUIZ ---
        
        // --- Perguntas de √Åudio B1 (Mike) - URL ATUALIZADA ---
        const audioB1Questions = [
            { 
                type: 'audio-mc', 
                level: 'B1', 
                audioSrc: 'https://res.cloudinary.com/dqfi22uz0/video/upload/v1759293315/audio_a1_rlrrzv.wav', 
                question: "1. Why does Mike enjoy visiting new places?", 
                options: ["He likes learning new languages", "He enjoys meeting new people", "He wants to take photographs", "He prefers cities to countryside"], 
                correctAnswer: 1, 
                explanation: "Mike diz que gosta de viajar e visitar novos lugares, e ele afirma: 'I‚Äôm a friendly person, and I enjoy meeting new people'." 
            },
            { 
                type: 'audio-mc', 
                level: 'B1', 
                audioSrc: 'https://res.cloudinary.com/dqfi22uz0/video/upload/v1759293315/audio_a1_rlrrzv.wav', 
                question: "2. What can we infer about Mike‚Äôs personality?", 
                options: ["He is shy and quiet", "He is friendly and outgoing", "He prefers staying at home", "He is competitive in sports only"], 
                correctAnswer: 1, 
                explanation: "Mike diz: 'I‚Äôm a friendly person, and I enjoy meeting new people', o que sugere que ele √© extrovertido (outgoing)." 
            },
            { 
                type: 'audio-mc', 
                level: 'B1', 
                audioSrc: 'https://res.cloudinary.com/dqfi22uz0/video/upload/v1759293315/audio_a1_rlrrzv.wav', 
                question: "3. Which sentence is TRUE according to the text?", 
                options: ["Mike works in a large company", "Mike hopes to travel to Europe next year", "Mike likes creative work", "Mike dislikes going to the gym"], 
                correctAnswer: 2, 
                explanation: "Mike afirma: 'I like my job because I can be creative'." 
            },
        ];

        // --- Perguntas de √Åudio B2 (Betrayal) - URL ATUALIZADA ---
        const audioB2Questions = [
            { 
                type: 'audio-mc', 
                level: 'B2', 
                audioSrc: 'https://res.cloudinary.com/dqfi22uz0/video/upload/v1759293323/audio_c2_utzcfi.wav', 
                question: "1. What hurt the narrator the most about the betrayal?", 
                options: ["The act of betrayal itself", "The slow realization of the lost intimacy", "A dramatic confrontation", "A sudden revelation"], 
                correctAnswer: 1, 
                explanation: "O narrador diz que o que mais o feriu n√£o foi o ato em si, mas 'the slow realization that the intimacy we had built together... had been quietly dismantled'." 
            },
            { 
                type: 'audio-mc', 
                level: 'B2', 
                audioSrc: 'https://res.cloudinary.com/dqfi22uz0/video/upload/v1759293323/audio_c2_utzcfi.wav', 
                question: "2. How did the narrator discover the betrayal?", 
                options: ["Through direct confrontation", "By noticing small changes and feelings of distance", "Through messages from friends", "With the help of a detective"], 
                correctAnswer: 1, 
                explanation: "O narrador afirma que 'The discovery was not cinematic. Instead, it unfolded in fragments: a strange distance in his eyes, an unconvincing smile...'" 
            },
            { 
                type: 'audio-mc', 
                level: 'B2', 
                audioSrc: 'https://res.cloudinary.com/dqfi22uz0/video/upload/v1759293323/audio_c2_utzcfi.wav', 
                question: "3. Which statement is TRUE according to the text?", 
                options: ["The betrayal made the narrator feel stronger immediately", "The betrayal destroyed the narrator‚Äôs trust and sense of security", "The betrayal was quickly forgotten", "The betrayal was anticipated from the beginning"], 
                correctAnswer: 1, 
                explanation: "O texto diz que a trai√ß√£o estava 'corroding my sense of security and even my own self-worth'." 
            },
            { 
                type: 'audio-mc', 
                level: 'B2', 
                audioSrc: 'https://res.cloudinary.com/dqfi22uz0/video/upload/v1759293323/audio_c2_utzcfi.wav', 
                question: "4. How does the narrator feel about the betrayal in retrospect?", 
                options: ["Completely resentful", "Grateful for the lessons learned", "Indifferent and unaffected", "Confused and angry"], 
                correctAnswer: 1, 
                explanation: "O narrador diz: 'looking back, I almost feel grateful. The betrayal stripped away the illusions'." 
            },
            { 
                type: 'audio-mc', 
                level: 'B2', 
                audioSrc: 'https://res.cloudinary.com/dqfi22uz0/video/upload/v1759293323/audio_c2_utzcfi.wav', 
                question: "5. What lesson does the narrator highlight at the end of the text?", 
                options: ["Love is easy to maintain without honesty", "Loyalty cannot be demanded; it must be chosen", "Betrayal should always be forgiven", "Trust can be rebuilt immediately after a betrayal"], 
                correctAnswer: 1, 
                explanation: "A li√ß√£o final √©: 'I learned, painfully, that loyalty cannot be demanded‚Äîit must be chosen, day after day'." 
            },
        ];

        // --- Perguntas de √Åudio C1 (Floods) - URL ATUALIZADA ---
        const audioC1Questions = [
            { 
                type: 'audio-mc', 
                level: 'C1', 
                audioSrc: 'https://res.cloudinary.com/dqfi22uz0/video/upload/v1759293335/audio_c1_lhhxsl.wav', 
                question: "1. What caused the floods in Northern Italy in May 2023?", 
                options: ["Earthquakes", "Heavy rainfall", "Storm surges from the sea", "Deforestation"], 
                correctAnswer: 1, 
                explanation: "O relat√≥rio menciona que as inunda√ß√µes foram causadas por 'unusually heavy rainfall' (chuva excepcionalmente forte)." 
            },
            { 
                type: 'audio-mc', 
                level: 'C1', 
                audioSrc: 'https://res.cloudinary.com/dqfi22uz0/video/upload/v1759293335/audio_c1_lhhxsl.wav', 
                question: "2. Which of the following was NOT mentioned as being affected by the floods?", 
                options: ["Homes", "Roads", "Agricultural land", "Airports"], 
                correctAnswer: 3, 
                explanation: "O texto menciona 'homes, roads, and agricultural land', mas n√£o menciona 'Airports'." 
            },
            { 
                type: 'audio-mc', 
                level: 'C1', 
                audioSrc: 'https://res.cloudinary.com/dqfi22uz0/video/upload/v1759293335/audio_c1_lhhxsl.wav', 
                question: "3. Why do experts link the floods to climate change?", 
                options: ["Because climate change reduces rainfall", "Because climate change increases the intensity of rainfall", "Because climate change makes rivers smaller", "Because climate change prevents evacuations"], 
                correctAnswer: 1, 
                explanation: "O texto diz que as mudan√ßas clim√°ticas intensificaram a chuva: 'climate change played a major role in intensifying the rainfall'." 
            },
            { 
                type: 'audio-mc', 
                level: 'C1', 
                audioSrc: 'https://res.cloudinary.com/dqfi22uz0/video/upload/v1759293335/audio_c1_lhhxsl.wav', 
                question: "4. What recommendation do experts make after the floods?", 
                options: ["To move people to other countries", "To invest in better flood defenses and infrastructure", "To stop farming in flood-prone areas", "To build more emergency shelters only"], 
                correctAnswer: 1, 
                explanation: "A recomenda√ß√£o √©: 'urgent investment in sustainable infrastructure, better flood defenses, and stronger disaster-preparedness measures'." 
            },
            { 
                type: 'audio-mc', 
                level: 'C1', 
                audioSrc: 'https://res.cloudinary.com/dqfi22uz0/video/upload/v1759293335/audio_c1_lhhxsl.wav', 
                question: "5. What is the main purpose of this report?", 
                options: ["To entertain readers with stories about floods", "To inform readers about the floods and their consequences", "To explain why floods are common in Italy", "To describe travel destinations in Northern Italy"], 
                correctAnswer: 1, 
                explanation: "O prop√≥sito principal de um 'Report' em um contexto formal √© 'to inform'." 
            },
        ];


        // --- Demais Perguntas (M√∫ltipla Escolha e Preenchimento) - EXCLUINDO AS DE √ÅUDIO PARA EVITAR DUPLICA√á√ÉO ---
        const allQuestions = [
            // --- A1 Level (5 questions) ---
            { type: 'multiple-choice', level: 'A1', question: "Where ___ you from?", options: ["is", "are", "am", "be"], correctAnswer: 1, explanation: "Usamos 'are' com o pronome 'you' para fazer perguntas com o verbo 'to be'." },
            { type: 'fill-in', level: 'A1', question: "My flight is ___ March 15th.", correctAnswer: ['on'], explanation: "Usamos a preposi√ß√£o 'on' para datas espec√≠ficas." },
            { type: 'multiple-choice', level: 'A1', question: "Look at that new Tesla. ___ color is red.", options: ["Her", "His", "Its", "Their"], correctAnswer: 2, explanation: "'Its' √© o pronome possessivo neutro, usado para objetos ('Tesla')." },
            { type: 'fill-in', level: 'A1', question: "Hello! My name is David. What is ___ name?", correctAnswer: ['your'], explanation: "O pronome possessivo 'your' (seu/sua) √© usado para perguntar o nome da pessoa com quem se est√° falando." },
            { type: 'multiple-choice', level: 'A1', question: "We go to the park ___ the weekend.", options: ["at", "in", "on", "for"], correctAnswer: 0, explanation: "Nos EUA, usa-se 'on the weekend'; no Reino Unido, 'at the weekend'. Ambos s√£o aceitos, mas 'at' √© uma op√ß√£o comum." },
            
            // --- A2 Level (19 questions) ---
            { type: 'multiple-choice', level: 'A2', question: "I love that new Netflix series. I ___ the first episode last night.", options: ["watch", "watched", "watching", "have watched"], correctAnswer: 1, explanation: "'Watched' √© o passado simples, usado para uma a√ß√£o conclu√≠da no passado ('last night')." },
            { type: 'fill-in', level: 'A2', question: "The weather in Rio is ___ better than the weather in London.", correctAnswer: ['much'], explanation: "Usamos 'much' para intensificar comparativos (ex: 'much better', 'much faster')." },
            { type: 'multiple-choice', level: 'A2', question: "While I was scrolling on Instagram, my mom ___ me a message.", options: ["send", "sended", "sent", "sented"], correctAnswer: 2, explanation: "O Simple Past do verbo irregular 'to send' √© 'sent', usado para a a√ß√£o que interrompeu o 'scrolling'." },
            { type: 'fill-in', level: 'A2', question: "I need to buy a new charger. I don't have ___ battery left.", correctAnswer: ['any'], explanation: "Usamos 'any' em frases negativas com substantivos incont√°veis ou no plural." },
            { type: 'multiple-choice', level: 'A2', question: "The iPhone 15 is ___ expensive than the previous model.", options: ["most", "more", "much", "more much"], correctAnswer: 1, explanation: "Usamos 'more' para formar o comparativo com adjetivos longos." },
            { type: 'fill-in', level: 'A2', question: "The team meeting is scheduled ___ 2 PM on Tuesday.", correctAnswer: ['at'], explanation: "Usamos a preposi√ß√£o 'at' para horas espec√≠ficas." },
            { type: 'multiple-choice', level: 'A2', question: "Tomorrow is my last day. I ___ travel next week.", options: ["am going to", "will", "go to", "goes to"], correctAnswer: 0, explanation: "'Am going to' √© usado para expressar planos futuros que j√° foram decididos (inten√ß√£o)." },
            { type: 'fill-in', level: 'A2', question: "We are meeting our friends ___ Saturday evening.", correctAnswer: ['on'], explanation: "Usamos a preposi√ß√£o 'on' para dias espec√≠ficos da semana." },
            { type: 'multiple-choice', level: 'A2', question: "The new app isn't as ___ as the old one.", options: ["fast", "faster", "fastest", "more fast"], correctAnswer: 0, explanation: "A estrutura comparativa de igualdade √© 'as + adjetivo na forma base + as'." },
            { type: 'fill-in', level: 'A2', question: "How ___ time do you spend on TikTok every day?", correctAnswer: ['much'], explanation: "Usamos 'much' para substantivos incont√°veis, como 'time'." },
            { type: 'multiple-choice', level: 'A2', question: "My colleagues ___ working remotely next month.", options: ["is", "are", "am", "be"], correctAnswer: 1, explanation: "O verbo 'to be' no presente com 'my colleagues' (plural) √© 'are', formando o Present Continuous para futuro agendado." },
            { type: 'fill-in', level: 'A2', question: "The project was delayed, ___ we missed the deadline.", correctAnswer: ['so'], explanation: "A conjun√ß√£o 'so' √© usada para expressar resultado ou consequ√™ncia." },
            { type: 'multiple-choice', level: 'A2', question: "I'm sure the new movie ___ be a blockbuster.", options: ["will", "is going to", "rains", "may"], correctAnswer: 0, explanation: "Usamos 'will' para previs√µes simples, especialmente quando baseadas em opini√£o ('I'm sure')." },
            { type: 'fill-in', level: 'A2', question: "You need to apologize ___ your behavior.", correctAnswer: ['for'], explanation: "O verbo 'apologize' √© seguido pela preposi√ß√£o 'for' quando se pede desculpas por algo." },
            { type: 'multiple-choice', level: 'A2', question: "Can you ___ a decision by the end of the day?", options: ["do", "make", "take", "give"], correctAnswer: 1, explanation: "A colocation correta √© 'to make a decision'." },
            { type: 'fill-in', level: 'A2', question: "When I had more free time, I ___ go hiking every weekend.", correctAnswer: ['used to'], explanation: "A estrutura 'used to' √© usada para h√°bitos e estados no passado que n√£o s√£o mais verdadeiros." },
            { type: 'multiple-choice', level: 'A2', question: "There are ___ people waiting in line for the concert tickets.", options: ["a little", "much", "a lot of", "any"], correctAnswer: 2, explanation: "'A lot of' √© usado com substantivos cont√°veis no plural ('people') em frases afirmativas." },
            { type: 'fill-in', level: 'A2', question: "She enjoys ___ new languages in her free time.", correctAnswer: ['learning'], explanation: "O verbo 'enjoy' √© seguido por um ger√∫ndio (-ing)." },
            { type: 'multiple-choice', level: 'A2', question: "He ___ his phone when the boss walked in.", options: ["was using", "used", "uses", "using"], correctAnswer: 0, explanation: "O Past Continuous ('was using') descreve a a√ß√£o em curso interrompida pelo Simple Past." },

            // --- B1 Level (30 questions) ---
            { type: 'multiple-choice', level: 'B1', question: "If I ___ the founder of this startup, I would hire more developers.", options: ["am", "were", "was", "have been"], correctAnswer: 1, explanation: "Em Second Conditional (situa√ß√µes hipot√©ticas ou irreais), usamos 'were' para todas as pessoas ap√≥s 'if I' ('If I were you')." },
            { type: 'fill-in', level: 'B1', question: "She told her friend that she ___ finished editing the video.", correctAnswer: ['had'], explanation: "No Reported Speech, o Present Perfect ('I have finished') se transforma em Past Perfect ('she had finished')." },
            { type: 'multiple-choice', level: 'B1', question: "The new app update ___ last week by the development team.", options: ["delivered", "was delivered", "has delivered", "is delivering"], correctAnswer: 1, explanation: "√â a Voz Passiva no Simple Past ('was delivered'), usada quando o agente ('development team') √© mencionado e a a√ß√£o ocorreu no passado ('last week')." },
            { type: 'fill-in', level: 'B1', question: "The film festival has been running ___ September.", correctAnswer: ['since'], explanation: "Usamos 'since' para indicar o ponto de in√≠cio de uma a√ß√£o que continua at√© o presente (Present Perfect)." },
            { type: 'multiple-choice', level: 'B1', question: "You ___ share your password with anyone. It's against company policy.", options: ["should", "must not", "can't", "may not"], correctAnswer: 1, explanation: "'Must not' √© usado para expressar uma proibi√ß√£o forte ou uma regra estrita." },
            { type: 'multiple-choice', level: 'B1', question: "___ the recent market volatility, the stock remains stable.", options: ["Despite", "Although", "In spite of the", "Even though"], correctAnswer: 0, explanation: "'Despite' e 'In spite of' s√£o seguidos por substantivo (market volatility). 'Despite' √© a forma mais concisa." },
            { type: 'fill-in', level: 'B1', question: "I've been using this phone ___ almost two years.", correctAnswer: ['for'], explanation: "Usamos 'for' com o Present Perfect para indicar a dura√ß√£o de um per√≠odo de tempo." },
            { type: 'multiple-choice', level: 'B1', question: "If you want to save energy, you should ___ the lights when you leave.", options: ["turn off", "to turn off", "turning off", "turned off"], correctAnswer: 0, explanation: "Ap√≥s verbos modais como 'should', usamos a forma base (infinitivo sem 'to') do phrasal verb 'turn off'." },
            { type: 'fill-in', level: 'B1', question: "I need to ___ up on the latest tech news.", correctAnswer: ['catch'], explanation: "O phrasal verb 'catch up on' significa inteirar-se, atualizar-se." },
            { type: 'multiple-choice', level: 'B1', question: "The conference covers several topics, ___ AI and machine learning.", options: ["besides", "except", "apart", "moreover"], correctAnswer: 0, explanation: "'Besides' significa 'al√©m de' ou 'em adi√ß√£o a', indicando que AI e machine learning s√£o t√≥picos adicionais." },
            { type: 'fill-in', level: 'B1', question: "If the product succeeds, we ___ launch it globally.", correctAnswer: ['will'], explanation: "Em First Conditional (situa√ß√µes reais ou prov√°veis), a cl√°usula principal usa 'will' + infinitivo." },
            { type: 'multiple-choice', level: 'B1', question: "Online learning is often ___ expensive than traditional classes.", options: ["fewer", "less", "least", "little"], correctAnswer: 1, explanation: "'Less' √© usado com substantivos incont√°veis ('expensive' funciona como incont√°vel neste comparativo)." },
            { type: 'fill-in', level: 'B1', question: "He wishes he ___ more confident when presenting.", correctAnswer: ['were'], explanation: "Em estruturas de desejo ('I wish'), usamos 'were' ap√≥s o sujeito para expressar um desejo irreal sobre o presente." },
            { type: 'multiple-choice', level: 'B1', question: "I'm looking forward ___ the new season of the show.", options: ["to watch", "to watching", "watch", "watching"], correctAnswer: 1, explanation: "A express√£o 'look forward to' √© seguida por um ger√∫ndio (-ing)." },
            { type: 'fill-in', level: 'B1', question: "She is used to ___ deadlines at work.", correctAnswer: ['meeting'], explanation: "A express√£o 'be used to' (estar habituado a) √© seguida por um ger√∫ndio (-ing)." },
            { type: 'multiple-choice', level: 'B1', question: "They regret ___ the sensitive data.", options: ["not encrypting", "not to encrypt", "to not encrypt", "not encrypt"], correctAnswer: 0, explanation: "O verbo 'regret' seguido de ger√∫ndio ('not encrypting') significa arrepender-se de algo que foi feito ou n√£o no passado." },
            { type: 'fill-in', level: 'B1', question: "The company, ___ was founded in 2005, is now a multinational.", correctAnswer: ['which'], explanation: "'Which' √© usado para introduzir uma cl√°usula relativa n√£o restritiva sobre coisas." },
            { type: 'multiple-choice', level: 'B1', question: "He advised ___ the terms and conditions carefully.", options: ["read", "to read", "reading", "to reading"], correctAnswer: 2, explanation: "O verbo 'advise' √© seguido por um ger√∫ndio (-ing) quando n√£o h√° um objeto expl√≠cito." },
            { type: 'fill-in', level: 'B1', question: "I found the interface confusing ___ first.", correctAnswer: ['at'], explanation: "A express√£o correta √© 'at first' (a princ√≠pio)." },
            { type: 'multiple-choice', level: 'B1', question: "They promised ___ the bug by the next update.", options: ["to fix", "fixing", "fix", "for fixing"], correctAnswer: 0, explanation: "O verbo 'promise' √© seguido pelo infinitivo ('to fix')." },
            { type: 'fill-in', level: 'B1', question: "I wish I ___ a better laptop for coding.", correctAnswer: ['had'], explanation: "Usamos 'I wish + Simple Past' para expressar um desejo irreal sobre o presente." },
            { type: 'multiple-choice', level: 'B1', question: "Do you mind ___ the volume down?", options: ["turn", "turning", "to turn", "turned"], correctAnswer: 1, explanation: "A express√£o 'Do you mind' √© sempre seguida por um ger√∫ndio (-ing)." },
            { type: 'fill-in', level: 'B1', question: "We ran out ___ cloud storage this month.", correctAnswer: ['of'], explanation: "O phrasal verb 'run out of' significa ficar sem algo." },
            { type: 'multiple-choice', level: 'B1', question: "He ought ___ his investors before making the announcement.", options: ["consult", "to consult", "consulting", "consulted"], correctAnswer: 1, explanation: "O modal 'ought' √© sempre seguido por 'to' + infinitivo ('to consult')." },
            { type: 'fill-in', level: 'B1', question: "I'm not keen ___ buying a virtual reality headset.", correctAnswer: ['on'], explanation: "A express√£o 'keen on' significa gostar ou estar interessado em algo." },
            { type: 'multiple-choice', level: 'B1', question: "The interviewer asked me what ___ doing next year.", options: ["was I", "I was", "I am", "am I"], correctAnswer: 1, explanation: "Em perguntas indiretas (Reported Speech), a ordem da frase √© sujeito + verbo ('I was')." },
            { type: 'fill-in', level: 'B1', question: "The code, ___ was reviewed by the seniors, is ready for production.", correctAnswer: ['which'], explanation: "Esta √© uma cl√°usula relativa reduzida ('which was reviewed')." },
            { type: 'multiple-choice', level: 'B1', question: "We decided ___ to the digital marketing course instead of the programming one.", options: ["go", "going", "to go", "went"], correctAnswer: 2, explanation: "O verbo 'decide' √© seguido pelo infinitivo ('to go')." },
            { type: 'multiple-choice', level: 'B1', question: "The update hasn't been released ___.", options: ["ago", "since", "for", "yet"], correctAnswer: 3, explanation: "Usamos 'yet' em frases negativas ou interrogativas com o Present Perfect para indicar que algo n√£o aconteceu at√© agora." },
            { type: 'fill-in', level: 'B1', question: "The influencer admitted ___ accepted payment for the fake review.", correctAnswer: ['having'], explanation: "O verbo 'admit' √© seguido pelo ger√∫ndio simples ('accepting') ou pelo ger√∫ndio perfeito ('having accepted') para enfatizar o tempo." },

            // --- B2 Level (25 questions) ---
            { type: 'fill-in', level: 'B2', question: "He is very adept ___ social media management.", correctAnswer: ['at'], explanation: "O adjetivo 'adept' (habilidoso) √© seguido pela preposi√ß√£o 'at'." },
            { type: 'multiple-choice', level: 'B2', question: "By the time the stream started, thousands of users had ___ joined.", options: ["yet", "still", "just", "already"], correctAnswer: 3, explanation: "'Already' √© usado com o Past Perfect para enfatizar que uma a√ß√£o aconteceu antes de outra no passado." },
            { type: 'fill-in', level: 'B2', question: "Despite ___ a strong market strategy, the product failed.", correctAnswer: ['having'], explanation: "A preposi√ß√£o 'despite' √© seguida por um substantivo ou um ger√∫ndio ('having')." },
            { type: 'multiple-choice', level: 'B2', question: "I wish I ___ that comment in the group chat. It caused too much drama.", options: ["hadn't made", "didn't make", "wouldn't make", "haven't made"], correctAnswer: 0, explanation: "Usamos 'I wish + Past Perfect' para expressar arrependimento sobre uma a√ß√£o passada." },
            { type: 'multiple-choice', level: 'B2', question: "If the server hadn't crashed, we ___ the entire project on time.", options: ["would have finished", "would finish", "finished", "had finished"], correctAnswer: 0, explanation: "Esta √© uma Third Conditional, a cl√°usula principal deve usar 'would have' + partic√≠pio passado." },
            { type: 'fill-in', level: 'B2', question: "The celebrity must ___ seen the paparazzi, they look shocked.", correctAnswer: ['have'], explanation: "O Modal Perfect 'must have seen' √© usado para fazer uma dedu√ß√£o l√≥gica e forte sobre uma a√ß√£o passada." },
            { type: 'multiple-choice', level: 'B2', question: "The developer apologized for ___ the bug.", options: ["to cause", "causing", "to causing", "have caused"], correctAnswer: 1, explanation: "O verbo 'apologize' √© seguido pela preposi√ß√£o 'for', que por sua vez √© seguida por um ger√∫ndio ('causing')." },
            { type: 'fill-in', level: 'B2', question: "Not only did he design the website, but he ___ programmed the backend.", correctAnswer: ['also'], explanation: "A estrutura 'Not only... but also...' √© usada para ligar duas ideias de igual import√¢ncia." },
            { type: 'multiple-choice', level: 'B2', question: "The viral meme, ___ reached over a million shares, originated here.", options: ["which", "that", "what", "who"], correctAnswer: 0, explanation: "'Which' √© usado para introduzir uma cl√°usula relativa n√£o restritiva sobre coisas." },
            { type: 'fill-in', level: 'B2', question: "The company proceeded with the launch, ___ the negative press coverage.", correctAnswer: ['irrespective of'], explanation: "O conector 'irrespective of' significa 'independentemente de' e √© uma locu√ß√£o preposicional formal." },
            { type: 'multiple-choice', level: 'B2', question: "You should have ___ the fine print before clicking 'Accept'.", options: ["read", "readed", "reading", "to read"], correctAnswer: 0, explanation: "O Modal Perfect 'should have read' √© usado para criticar uma a√ß√£o passada ('read' √© o partic√≠pio passado de 'to read')." },
            { type: 'fill-in', level: 'B2', question: "I wish I ___ able to code in Python.", correctAnswer: ['were'], explanation: "Assim como no Second Conditional, 'I wish' frequentemente usa 'were' para expressar situa√ß√µes irreais no presente." },
            { type: 'multiple-choice', level: 'B2', question: "The new series is ___ to be the most successful of the year.", options: ["due", "bound", "likely", "certain"], correctAnswer: 0, explanation: "A express√£o 'due to' √© usada para agendamentos ou eventos esperados/previstos." },
            { type: 'fill-in', level: 'B2', question: "She found it difficult to ___ up with the latest software changes.", correctAnswer: ['keep'], explanation: "O phrasal verb 'keep up with' significa acompanhar o ritmo." },
            { type: 'multiple-choice', level: 'B2', question: "___ a consequence of the update, the server crashed.", options: ["As", "For", "In", "With"], correctAnswer: 0, explanation: "A express√£o idiom√°tica correta para indicar causa/consequ√™ncia √© 'As a consequence of'." },
            { type: 'fill-in', level: 'B2', question: "The streaming service seems to ___ completely dominated the market.", correctAnswer: ['have'], explanation: "O Perfect Infinitive 'to have dominated' √© usado ap√≥s 'seem' para indicar uma a√ß√£o passada." },
            { type: 'multiple-choice', level: 'B2', question: "The intern was made ___ the boring data entry.", options: ["do", "doing", "to do", "done"], correctAnswer: 0, explanation: "Na voz passiva, o verbo causativo 'make' perde o 'to' do infinitivo ('to do' vira 'do')." },
            { type: 'fill-in', level: 'B2', question: "The comments were so funny that I couldn't help ___ laughing.", correctAnswer: ['bursting out'], explanation: "A express√£o 'can't help' √© seguida por um ger√∫ndio ('bursting out laughing')." },
            { type: 'multiple-choice', level: 'B2', question: "They managed ___ the tight deadline despite the low budget.", options: ["to meet", "meeting", "meet", "in meeting"], correctAnswer: 0, explanation: "O verbo 'manage' √© seguido pelo infinitivo ('to meet')." },
            { type: 'fill-in', level: 'B2', question: "She insisted ___ paying for the Uber.", correctAnswer: ['on'], explanation: "O verbo 'insist' √© seguido pela preposi√ß√£o 'on'." },
            { type: 'multiple-choice', level: 'B2', question: "The new feature was met with ___ criticism from early users.", options: ["fierce", "sharp", "strong, keen"], correctAnswer: 0, explanation: "'Fierce' (feroz/forte) √© a colocation mais natural para descrever oposi√ß√£o intensa." },
            { type: 'fill-in', level: 'B2', question: "It's high time you ___ your subscription to the old software.", correctAnswer: ['cancelled'], explanation: "A express√£o 'It's high time' √© seguida pelo Simple Past para expressar que a a√ß√£o deveria ter acontecido antes." },
            { type: 'multiple-choice', level: 'B2', question: "I regret ___ you that the funding was cut.", options: ["to inform", "informing", "inform", "to informing"], correctAnswer: 0, explanation: "O verbo 'regret' seguido pelo infinitivo ('to inform') √© usado para dar not√≠cias ruins ou formais." },
            { type: 'fill-in', level: 'B2', question: "The meeting atmosphere was fraught ___ tension.", correctAnswer: ['with'], explanation: "O adjetivo 'fraught' (cheio/carregado) √© seguido pela preposi√ß√£o 'with'." },
            { type: 'multiple-choice', level: 'B2', question: "___ the bad connection, the video conference went smoothly.", options: ["Despite of", "Even though", "In spite of", "Although"], correctAnswer: 2, explanation: "'In spite of' √© a op√ß√£o correta. 'Despite' n√£o leva 'of'." },
            
            // --- C1 Level (15 questions) ---
            { type: 'fill-in', level: 'C1', question: "Not only ___ the data accurate, but the analysis was brilliant.", correctAnswer: ['was'], explanation: "Quando a frase come√ßa com uma express√£o negativa ('Not only'), o sujeito e o verbo auxiliar s√£o invertidos ('was the data')." },
            { type: 'multiple-choice', level: 'C1', question: "The company had to ___ a number of employees due to the recent acquisition.", options: ["lay off", "put off", "call off", "see off"], correctAnswer: 0, explanation: "O phrasal verb 'lay off' significa demitir funcion√°rios, geralmente por raz√µes econ√¥micas." },
            { type: 'fill-in', level: 'C1', question: "The new feature was met with ___ adoption by users.", correctAnswer: ['widespread'], explanation: "'Widespread' √© uma colocation comum com 'adoption' (ado√ß√£o generalizada)." },
            { type: 'multiple-choice', level: 'C1', question: "If you 'let the cat out of the bag', you...", options: ["buy a new pet", "feel very ill", "reveal a secret by mistake", "start a new hobby"], correctAnswer: 2, explanation: "'To let the cat out of the bag' √© uma express√£o idiom√°tica que significa revelar um segredo acidentalmente." },
            { type: 'multiple-choice', level: 'C1', question: "Hardly ___ finished the presentation when the power went out.", options: ["had I", "I had", "have I", "I have"], correctAnswer: 0, explanation: "Invers√£o avan√ßada: 'Hardly' no in√≠cio da frase exige a invers√£o do verbo auxiliar e do sujeito ('had I')." },
            { type: 'fill-in', level: 'C1', question: "___ the fact that the company was struggling, they invested heavily in R&D.", correctAnswer: ['Given'], explanation: "'Given' como preposi√ß√£o significa 'considerando' e √© usado em contextos formais." },
            { type: 'multiple-choice', level: 'C1', question: "It was only when I saw the invoice ___ I realized the extra costs.", options: ["that", "when", "which", "then"], correctAnswer: 0, explanation: "Em Cleft Sentences (frases de √™nfase) com 'It was only when...', usamos 'that' para introduzir a segunda parte." },
            { type: 'fill-in', level: 'C1', question: "The success of the campaign hinges ___ the accuracy of the data.", correctAnswer: ['on'], explanation: "O phrasal verb 'hinge on' significa depender inteiramente de algo." },
            { type: 'multiple-choice', level: 'C1', question: "The sheer ___ of the project documentation was daunting.", options: ["magnitude", "plentiful", "greatly", "numerous"], correctAnswer: 0, explanation: "'Magnitude' √© o substantivo correto, e a colocation 'sheer magnitude' √© comum no n√≠vel C1." },
            { type: 'fill-in', level: 'C1', question: "There is a crying ___ for new regulatory standards.", correctAnswer: ['need'], explanation: "A colocation fixa 'a crying need' significa uma necessidade urgente ou √≥bvia." },
            { type: 'multiple-choice', level: 'C1', question: "We must take into ___ the ethical implications of the AI.", options: ["account", "consideration", "thought", "mind"], correctAnswer: 0, explanation: "A colocation idiom√°tica correta √© 'to take into account' (levar em considera√ß√£o)." },
            { type: 'fill-in', level: 'C1', question: "The design received universal ___ from critics.", correctAnswer: ['approbation'], explanation: "'Approabation' √© sin√¥nimo de aprova√ß√£o, mas √© uma palavra de n√≠vel C1." },
            { type: 'multiple-choice', level: 'C1', question: "I would sooner ___ the beta version than wait for the full release.", options: ["test", "tested", "to test", "testing"], correctAnswer: 0, explanation: "A estrutura 'I would sooner/rather' (eu preferiria) √© seguida pelo infinitivo sem 'to'." },
            { type: 'fill-in', level: 'C1', question: "___ no circumstances should the backdoor password be shared.", correctAnswer: ['Under'], explanation: "A express√£o de invers√£o avan√ßada √© 'Under no circumstances' (em hip√≥tese alguma)." },
            { type: 'multiple-choice', level: 'C1', question: "She is adept ___ debugging legacy code.", options: ["with", "at", "for", "in"], correctAnswer: 1, explanation: "O adjetivo 'adept' (proficiente/h√°bil) √© seguido pela preposi√ß√£o 'at'." },

            // --- C2 Level (25 questions) ---
            { type: 'fill-in', level: 'C2', question: "___ the developers known about the vulnerability, they would have patched it immediately.", correctAnswer: ['Had'], explanation: "Esta √© uma forma de 'Third Conditional' com invers√£o, omitindo 'if'. A estrutura √© 'Had + subject + past participle...'." },
            { type: 'multiple-choice', level: 'C2', question: "His argument contained several ___ contradictions.", options: ["glaring", "blatant", "flagrant", "all are correct"], correctAnswer: 3, explanation: "'Glaring', 'blatant' e 'flagrant' s√£o sin√¥nimos de '√≥bvio e chocante' e s√£o coloca√ß√µes apropriadas para descrever contradi√ß√µes graves." },
            { type: 'fill-in', level: 'C2', question: "The final product is the ___ of the company's innovation ethos.", correctAnswer: ['epitome'], explanation: "'Epitome' (o ep√≠tome) significa o exemplo perfeito ou a personifica√ß√£o de algo, um vocabul√°rio formal de C2." },
            { type: 'multiple-choice', level: 'C2', question: "The press release was an attempt to ___ the negative sentiment around the failure.", options: ["assuage", "exacerbate", "aggravate", "compound"], correctAnswer: 0, explanation: "'Assuage' significa aliviar ou acalmar (sentimentos). As outras op√ß√µes significam piorar." },
            { type: 'fill-in', level: 'C2', question: "The editor has a keen ___ for stylistic errors.", correctAnswer: ['eye'], explanation: "A express√£o idiom√°tica 'to have an eye for something' significa ter uma habilidade natural para julgar ou notar algo." },
            
            // --- C1-C2 Gap Fillers (25 questions) ---
            { type: 'fill-in', level: 'C2', question: "The series is a nuanced exploration of the human ___ .", correctAnswer: ['condition'], explanation: "'Condition' completa a colocation formal 'human condition' (condi√ß√£o humana)." },
            { type: 'multiple-choice', level: 'C2', question: "The scientist was widely regarded as a woman of great ___.", options: ["integrity", "integral", "integrate", "integrated"], correctAnswer: 0, explanation: "'Integrity' (integridade) √© o substantivo de n√≠vel C2 que se encaixa no contexto de car√°ter moral." },
            { type: 'fill-in', level: 'C2', question: "Suffice ___ to say, the pilot project was terminated.", correctAnswer: ['it'], explanation: "A express√£o formal √© 'Suffice it to say' (Basta dizer que...)." },
            { type: 'multiple-choice', level: 'C2', question: "The scandal eventually brought the whole department ___.", options: ["down", "over", "off", "up"], correctAnswer: 0, explanation: "O phrasal verb 'bring down' (derrubar) √© usado em contextos pol√≠ticos/formais." },
            { type: 'fill-in', level: 'C2', question: "The review offered a ___ critique of the latest smartphone model.", correctAnswer: ['scathing'], explanation: "'Scathing' (severa, c√°ustica) √© um adjetivo de vocabul√°rio C2 para descrever uma cr√≠tica muito dura." },
            { type: 'multiple-choice', level: 'C2', question: "So complex ___ that only three engineers understood it.", options: ["the code was", "was the code", "did the code was", "the code had"], correctAnswer: 1, explanation: "Invers√£o enf√°tica: Frases iniciadas com 'So' + adjetivo exigem invers√£o do verbo ('was the code')." },
            { type: 'fill-in', level: 'C2', question: "The app is scalable, ___ that the server capacity is maintained.", correctAnswer: ['provided'], explanation: "O conector formal 'provided that' (desde que/se) √© usado para introduzir uma condi√ß√£o." },
            { type: 'multiple-choice', level: 'C2', question: "The contract stipulated that the final payment must be made ___ delay.", options: ["without", "no", "with no", "not any"], correctAnswer: 0, explanation: "A colocation formal √© 'without delay' (sem demora)." },
            { type: 'fill-in', level: 'C2', question: "The zero-day vulnerability calls ___ immediate mitigation.", correctAnswer: ['for'], explanation: "O phrasal verb formal 'call for' significa exigir ou tornar necess√°rio." },
            { type: 'multiple-choice', level: 'C2', question: "The competitor resorted to ___ claims to discredit our product.", options: ["inflammatory", "flame", "inflaming", "ignite"], correctAnswer: 0, explanation: "'Inflammatory rhetoric' (ret√≥rica inflamat√≥ria) √© uma colocation C2 para linguagem que incita a raiva." },
            { type: 'fill-in', level: 'C2', question: "We can only surmise ___ the attacker's motive was.", correctAnswer: ['what'], explanation: "'Surmise' (conjecturar) √© um verbo C2, e 'what' introduz a cl√°usula substantiva que serve como objeto." },
            { type: 'multiple-choice', level: 'C2', question: "I was loath ___ a non-disclosure agreement with a new client.", options: ["to enter", "to enter into", "enter into", "enter to"], correctAnswer: 1, explanation: "'Loath to' (relutante em) √© seguido pelo infinitivo, e 'enter into' (iniciar um acordo) √© o phrasal verb correto." },
            { type: 'fill-in', level: 'C2', question: "The pervasive ___ of technical debt hampered innovation.", correctAnswer: ['nature'], explanation: "'Pervasive nature' (natureza generalizada) √© uma colocation C2 que se encaixa bem no contexto formal." },
            { type: 'multiple-choice', level: 'C2', question: "What ___ the complexity is the poor legacy documentation.", options: ["compound", "compounds", "is compounding", "to compound"], correctAnswer: 1, explanation: "O verbo 'compound' no presente simples ('compounds') funciona como a forma correta para descrever o que agrava a situa√ß√£o." },
            { type: 'fill-in', level: 'C2', question: "The auditors were advised to discount the figures, ___ their dubious source.", correctAnswer: ['given'], explanation: "Aqui 'given' funciona como 'considering' (dadas) no sentido de concess√£o formal, C2." },
            { type: 'multiple-choice', level: 'C2', question: "The dispute quickly escalated into a source of considerable ___.", options: ["acrimony", "acrimonious", "acrid", "acrimonies"], correctAnswer: 0, explanation: "'Acrimony' (acrim√¥nia/aspereza) √© o substantivo correto de n√≠vel C2." },
            { type: 'fill-in', level: 'C2', question: "The company acted in ___ of the user data protection policy.", correctAnswer: ['breach'], explanation: "A express√£o formal √© 'in breach of' (em viola√ß√£o de)." },
            { type: 'multiple-choice', level: 'C2', question: "He's not above ___ deceptive marketing tactics to gain an edge.", options: ["using", "to use", "use", "used to"], correctAnswer: 0, explanation: "A express√£o idiom√°tica 'not above using' significa 'n√£o hesitaria em usar' (uso de ger√∫ndio)." },
            { type: 'fill-in', level: 'C2', question: "The deployment was carried ___ in a meticulous fashion.", correctAnswer: ['out'], explanation: "O phrasal verb 'carry out' (executar/realizar) √© comum no n√≠vel C2 em contextos formais." },
            { type: 'multiple-choice', level: 'C2', question: "Little ___ the competitor know about our new product strategy.", options: ["did", "was", "has", "can"], correctAnswer: 0, explanation: "Invers√£o avan√ßada com 'Little' no in√≠cio da frase, exigindo o auxiliar 'did' + infinitivo ('did he know')." },
            { type: 'fill-in', level: 'C2', question: "It is incumbent ___ the Chief Security Officer to issue a public statement.", correctAnswer: ['on'], explanation: "O adjetivo 'incumbent' (incumbido/obrigat√≥rio) √© seguido pela preposi√ß√£o 'on' ou 'upon'." },
            { type: 'multiple-choice', level: 'C2', question: "She was blissfully ___ of the security vulnerabilities in the old server.", options: ["oblivious", "unaware", "ignorant", "unconscious"], correctAnswer: 0, explanation: "'Blissfully oblivious of' √© uma colocation de alto n√≠vel que significa 'desconhecer alegremente/inconscientemente'." },
            { type: 'fill-in', level: 'C2', question: "The sheer ___ of the required computational power was staggering.", correctAnswer: ['scale'], explanation: "'Sheer scale' (escala pura/imensid√£o) √© uma colocation para descrever magnitude f√≠sica." },
            { type: 'multiple-choice', level: 'C2', question: "He would have preferred ___ involved in the decision-making process sooner.", options: ["to have been", "to be", "being", "to have"], correctAnswer: 0, explanation: "Perfect Infinitive na voz passiva ('to have been informed') √© necess√°rio ap√≥s 'would have preferred'." },
            { type: 'fill-in', level: 'C2', question: "The management was quick to scotch ___ of a planned mass redundancy.", correctAnswer: ['rumours'], explanation: "O verbo 'scotch' (refutar) √© colocation de 'rumours' (rumores) em contextos pol√≠ticos/empresariais, C2." }
        ];


        let currentQuizQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;

        // --- FUN√á√ïES DE TEMPO ---
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
        
        function updateTimerDisplay() {
            const timeSinceStart = Math.floor((Date.now() - quizStartTime) / 1000);
            totalTimeElapsed = timeSinceStart; // Atualiza o tempo total decorrido
            const timeDisplay = quizView.querySelector('#timer-display');
            if (timeDisplay) {
                timeDisplay.textContent = formatTime(timeSinceStart);
            }
        }

        function startTimer() {
            quizStartTime = Date.now();
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(updateTimerDisplay, 1000);
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }
        
        // Fun√ß√£o para aplicar as classes de fundo ao body
        function setBodyBackground(viewId) {
            document.body.classList.remove('bg-dark', 'bg-yellow', 'bg-white-quiz', 'text-stone-100', 'text-stone-800');
            
            if (viewId === 'splash-1-view' || viewId === 'splash-2-view') {
                document.body.classList.add('bg-dark', 'text-stone-100');
            } else if (viewId === 'form-view') {
                document.body.classList.add('bg-yellow', 'text-stone-800');
            } else if (viewId === 'quiz-view' || viewId === 'result-view') {
                document.body.classList.add('bg-white-quiz', 'text-stone-800');
            }
            // O fallback 'bg-stone-200' do CSS original √© removido.
        }

        // --- FUN√á√ïES DE NAVEGA√á√ÉO ENTRE TELAS ---
        function hideAllViews() {
            splash1View.classList.add('hidden');
            splash2View.classList.add('hidden');
            formView.classList.add('hidden');
            quizView.classList.add('hidden');
            resultView.classList.add('hidden');
        }

        function startSplash1() {
            hideAllViews();
            setBodyBackground('splash-1-view');
            splash1View.classList.remove('hidden');
        }

        window.goToSplash2 = function() {
            hideAllViews();
            setBodyBackground('splash-2-view');
            splash2View.classList.remove('hidden');
        }
        
        window.goToForm = function() {
            hideAllViews();
            setBodyBackground('form-view');
            formView.classList.remove('hidden');
        }
        
        // --- EVENTO DE ENVIO DO FORMUL√ÅRIO (INICIA O QUIZ) ---
        leadForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            // Armazena os dados do utilizador
            studentName = document.getElementById('name').value;
            studentEmail = document.getElementById('email').value;
            studentWhatsapp = document.getElementById('whatsapp').value;

            // Esconde o formul√°rio e come√ßa o quiz
            formView.classList.add('hidden');
            setBodyBackground('quiz-view');
            quizView.classList.remove('hidden');
            startQuiz();
        });


        /**
         * Seleciona 15 quest√µes aleat√≥rias do pool de 100, garantindo a progress√£o A1 -> C2.
         * Quota: 2 A1, 3 A2, 4 B1, 3 B2, 2 C1, 1 C2 (Total 15)
         * Garantia: 1 slot B1 (Mike), 1 slot B2 (Betrayal) e 1 slot C1 (Floods) s√£o preenchidos por √°udio.
         */
        function selectAndOrderQuestions() {
            // Ajustamos a quota para que as 3 quest√µes de √°udio usem 1 slot em seus respectivos n√≠veis
            const initialQuota = { 'A1': 2, 'A2': 3, 'B1': 4, 'B2': 3, 'C1': 2, 'C2': 1 }; 
            let currentQuota = { ...initialQuota }; 
            let selectedQuestions = [];
            
            const shuffleArray = (array) => {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            };
            
            // 1. Garante que UMA das perguntas de √°udio B1 (Mike) seja selecionada
            const randomB1Index = Math.floor(Math.random() * audioB1Questions.length);
            selectedQuestions.push(audioB1Questions[randomB1Index]);
            currentQuota['B1']--; 
            
            // 2. Garante que UMA das perguntas de √°udio B2 (Betrayal) seja selecionada
            const randomB2Index = Math.floor(Math.random() * audioB2Questions.length);
            selectedQuestions.push(audioB2Questions[randomB2Index]);
            currentQuota['B2']--;
            
            // 3. Garante que UMA das perguntas de √°udio C1 (Floods) seja selecionada
            const randomC1Index = Math.floor(Math.random() * audioC1Questions.length);
            selectedQuestions.push(audioC1Questions[randomC1Index]);
            currentQuota['C1']--;
            
            // Separa as demais perguntas por n√≠vel (excluindo as de √°udio)
            const nonAudioQuestions = allQuestions.filter(q => q.type !== 'audio-mc');
            const questionsByLevel = nonAudioQuestions.reduce((acc, q) => {
                if (!acc[q.level]) acc[q.level] = [];
                acc[q.level].push(q);
                return acc;
            }, {});
            

            const levelsOrder = ['A1', 'A2', 'B1', 'B2', 'C1', 'C2'];
            
            for (const level of levelsOrder) {
                const levelQuestions = questionsByLevel[level] || [];
                const numToSelect = currentQuota[level] || 0;
                
                // Embaralha as quest√µes e pega o n√∫mero necess√°rio (restante da quota)
                shuffleArray(levelQuestions);
                selectedQuestions.push(...levelQuestions.slice(0, numToSelect));
            }

            // Ordena o quiz final pela ordem dos n√≠veis (A1, A2, B1, C1, C2)
            selectedQuestions.sort((a, b) => {
                const levelOrder = levelsOrder.indexOf(a.level) - levelsOrder.indexOf(b.level);
                if (levelOrder !== 0) return levelOrder;
                
                // Prioridade secund√°ria: ordenar √°udio dentro do seu n√≠vel
                // Garante que o √°udio B1 venha antes dos gramaticais B1, por exemplo.
                if (a.level === b.level && a.type === 'audio-mc' && b.type !== 'audio-mc') return -1;
                if (a.level === b.level && a.type !== 'audio-mc' && b.type === 'audio-mc') return 1;

                // Ordem aleat√≥ria final se todos os outros crit√©rios forem iguais
                return Math.random() - 0.5;
            });

            return selectedQuestions;
        }

        function startQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            // Usa a nova fun√ß√£o para selecionar as 15 quest√µes ordenadas
            currentQuizQuestions = selectAndOrderQuestions(); 
            
            quizView.classList.remove('hidden');
            resultView.classList.add('hidden');
            
            startTimer(); // Inicia o cron√≥metro
            displayQuestion();
        }

        function displayQuestion() {
            const quizContainer = quizView.querySelector('.p-6');
            if (currentQuestionIndex < currentQuizQuestions.length) {
                const questionData = currentQuizQuestions[currentQuestionIndex];
                const progressPercentage = ((currentQuestionIndex) / currentQuizQuestions.length) * 100;
                
                // Novo URL para o quiz (fundo branco)
                const quizLogoUrl = "https://res.cloudinary.com/dqfi22uz0/image/upload/v1759294967/SLAP_TIPO_PRETO_2_kismg9.png"; 

                let audioPlayerHtml = '';
                
                if (questionData.type === 'audio-mc') {
                    // Adiciona o player de √°udio para quest√µes de √°udio
                    // controlsList="nodownload" remove os 3 pontinhos
                    audioPlayerHtml = `<div class="mb-6 p-4 bg-stone-100 rounded-xl shadow-inner border border-stone-200">
                            <p class="text-sm font-semibold text-stone-600 mb-2 flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"></path><path d="M10 12V5a3 3 0 0 0-3-3l-2 1h-2v17h2l2 1a3 3 0 0 0 3-3v-7h11v2a3 3 0 0 0 3 3h-1l-2 1a3 3 0 0 0-3-3z"></path></svg>
                                Escute o √°udio com aten√ß√£o para responder:
                            </p>
                            <audio controls controlsList="nodownload" class="w-full">
                                <source src="${questionData.audioSrc}" type="audio/mp3">
                                Seu navegador n√£o suporta o elemento de √°udio.
                            </audio>
                        </div>`;
                }

                let questionContentHtml = '';
                if (questionData.type === 'multiple-choice' || questionData.type === 'audio-mc') {
                    questionContentHtml = `<div id="quiz-options">
                            ${questionData.options.map((option, index) => 
                                `<button class="quiz-option" onclick="selectAnswer(${index})">${option}</button>`
                            ).join('')}
                        </div>`;
                } else if (questionData.type === 'fill-in') {
                    questionContentHtml = `<div id="quiz-options" class="flex flex-col sm:flex-row items-center gap-4">
                            <input type="text" id="fill-in-answer" class="fill-in-input flex-grow" placeholder="Digite sua resposta aqui..." onkeydown="if(event.key==='Enter') checkFillInAnswer();">
                            <button class="action-button w-full sm:w-auto justify-center" onclick="checkFillInAnswer()">Confirmar</button>
                        </div>`;
                }

                quizContainer.innerHTML = `
                    <div id="quiz-content">
                         <div class="text-center mb-6">
                            <!-- √çcone para Fundo Branco (Quiz) - rounded-lg REMOVIDO -->
                            <img src="${quizLogoUrl}" alt="SLAP Logo Preto" class="w-32 h-auto mx-auto mb-4">
                         </div>
                         <div class="flex justify-between items-end mb-4">
                            <!-- Barra de Progresso e Contador de Quest√µes -->
                            <div>
                                <p class="text-sm font-semibold text-stone-500 mb-1">Quest√£o ${currentQuestionIndex + 1} de ${currentQuizQuestions.length}</p>
                                <div class="progress-bar-background">
                                    <div class="progress-bar-foreground" style="width: ${progressPercentage}%;"></div>
                                </div>
                            </div>
                            <!-- Cron√≥metro -->
                            <div class="text-right ml-4">
                                <p class="text-sm font-semibold text-stone-500">Tempo Decorrido</p>
                                <span id="timer-display" class="text-xl font-bold text-stone-700">00:00</span>
                            </div>
                         </div>
                        ${audioPlayerHtml}
                        <h3 class="text-xl font-bold mb-6 text-stone-800">${questionData.question}</h3>
                        ${questionContentHtml}
                        <div id="feedback-area" class="min-h-[6rem] mt-4"></div>
                        <div id="quiz-nav" class="mt-6 text-right">
                            <button class="skip-button" onclick="skipQuestion()">Pular Quest√£o &rarr;</button>
                        </div>
                    </div>`;
                
                setTimeout(() => {
                    quizContainer.querySelector('.progress-bar-foreground').style.width = `${((currentQuestionIndex + 1) / currentQuizQuestions.length) * 100}%`;
                }, 100);

                if (questionData.type === 'fill-in') {
                    document.getElementById('fill-in-answer').focus();
                }
            } else {
                showResult();
            }
        }

        function handleAnswer(isCorrect, explanation, correctAnswerText) {
            const feedbackArea = document.getElementById('feedback-area');
            const navArea = document.getElementById('quiz-nav');

            // Pausa o √°udio se estiver tocando ao responder
            const audioPlayer = document.querySelector('audio');
            if (audioPlayer) {
                audioPlayer.pause();
            }

            if (isCorrect) {
                score++;
                if(correctSound) correctSound.play();
                feedbackArea.innerHTML = `<div class="quiz-feedback correct"><strong>Correto!</strong> ${explanation}</div>`;
            } else {
                if(wrongSound) wrongSound.play();
                feedbackArea.innerHTML = `<div class="quiz-feedback incorrect">A resposta correta √© <strong>'${correctAnswerText}'</strong>. ${explanation}</div>`;
            }

            const buttonText = (currentQuestionIndex < currentQuizQuestions.length - 1) ? "Pr√≥xima Quest√£o" : "Ver Resultado";
            const nextFunction = (currentQuestionIndex < currentQuizQuestions.length - 1) ? "nextQuestion()" : "showResult()";
            
            navArea.innerHTML = `<button class="action-button" onclick="${nextFunction}">${buttonText} <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg></button>`;
        }

        function selectAnswer(selectedIndex) {
            const questionData = currentQuizQuestions[currentQuestionIndex];
            const options = document.querySelectorAll('#quiz-options .quiz-option');
            options.forEach(button => button.disabled = true);

            const isCorrect = selectedIndex === questionData.correctAnswer;
            const correctAnswerText = questionData.options[questionData.correctAnswer];
            
            if (isCorrect) {
                options[selectedIndex].classList.add('correct');
            } else {
                options[selectedIndex].classList.add('incorrect');
                options[questionData.correctAnswer].classList.add('correct');
            }
            
            handleAnswer(isCorrect, questionData.explanation, correctAnswerText);
        }

        function checkFillInAnswer() {
            const questionData = currentQuizQuestions[currentQuestionIndex];
            const inputField = document.getElementById('fill-in-answer');
            const userAnswer = inputField.value.trim().toLowerCase();
            
            inputField.disabled = true;
            document.querySelector('#quiz-options button').disabled = true;

            const correctAnswers = questionData.correctAnswer.map(ans => ans.toLowerCase());
            const isCorrect = correctAnswers.includes(userAnswer);

            handleAnswer(isCorrect, questionData.explanation, questionData.correctAnswer[0]);
        }
        
        function skipQuestion() {
            const questionData = currentQuizQuestions[currentQuestionIndex];
            const options = document.querySelectorAll('#quiz-options button, #quiz-options input');
            options.forEach(el => el.disabled = true);
            
            let correctAnswerText;
            if (questionData.type === 'multiple-choice' || questionData.type === 'audio-mc') {
                correctAnswerText = questionData.options[questionData.correctAnswer];
                const correctOptionButton = document.querySelectorAll('#quiz-options .quiz-option')[questionData.correctAnswer];
                if(correctOptionButton) correctOptionButton.classList.add('correct');
            } else {
                correctAnswerText = questionData.correctAnswer[0];
            }

            handleAnswer(false, `Pergunta pulada. ${questionData.explanation}`, correctAnswerText);
        }

        function nextQuestion() {
            currentQuestionIndex++;
            displayQuestion();
        }

        function showResult() {
            stopTimer(); // P√°ra o cron√≥metro
            quizView.classList.add('hidden');
            setBodyBackground('result-view');
            resultView.classList.remove('hidden');

            let level = '';
            let message = '';
            const total = currentQuizQuestions.length; // Deve ser 15
            
            const timeString = formatTime(totalTimeElapsed); // Formata o tempo

            // Nova Escala de N√≠vel (baseada em 15 quest√µes)
            if (score <= 3) { level = 'Iniciante (A1)'; message = 'Voc√™ est√° come√ßando a aprender ingl√™s. Foco nos fundamentos de gram√°tica e vocabul√°rio b√°sico.'; }
            else if (score <= 6) { level = 'B√°sico (A2)'; message = 'Voc√™ j√° entende e se comunica em situa√ß√µes simples do dia a dia. Continue praticando o passado e futuro.'; }
            else if (score <= 9) { level = 'Intermedi√°rio (B1)'; message = 'Muito bom! Voc√™ j√° tem independ√™ncia em diversas situa√ß√µes. √â hora de dominar o Present Perfect e as condicionais.'; }
            else if (score <= 12) { level = 'Intermedi√°rio Superior (B2)'; message = 'Excelente! Seu ingl√™s √© preciso e voc√™ consegue lidar com textos complexos e conversas detalhadas.'; }
            else if (score <= 14) { level = 'Avan√ßado (C1)'; message = 'Fant√°stico! Seu dom√≠nio do ingl√™s √© avan√ßado. Comece a explorar invers√µes e vocabul√°rio idiom√°tico.'; }
            else { level = 'Proficiente (C2)'; message = 'Parab√©ns! Seu n√≠vel de ingl√™s √© o mais alto. Um resultado impressionante!'; }
            
            document.getElementById('result-score').textContent = `Voc√™ acertou ${score} de ${total} quest√µes.`;
            document.getElementById('result-level').textContent = level;
            document.getElementById('result-message').textContent = message;
            document.getElementById('result-time').textContent = `Tempo total: ${timeString}`; // Exibe o tempo

            // Envia todos os dados para o Formspree
            const submissionData = new FormData();
            submissionData.append('Nome', studentName);
            submissionData.append('Email', studentEmail);
            submissionData.append('WhatsApp', studentWhatsapp);
            submissionData.append('Pontua√ß√£o', `${score} de ${total}`);
            submissionData.append('N√≠vel Estimado', level);
            submissionData.append('Tempo Total', timeString); // Adiciona o tempo final

            fetch(leadForm.action, {
                method: 'POST',
                body: submissionData,
                headers: { 'Accept': 'application/json' }
            }).then(response => {
                if (response.ok) {
                    console.log("Resultado enviado com sucesso para o Formspree.");
                } else {
                     console.error("Houve um problema ao enviar o resultado para o Formspree.");
                }
            }).catch(error => {
                console.error("Erro de conex√£o ao enviar o resultado:", error);
            });
        }

        function restartQuiz() {
            startSplash1();
            if(leadForm) leadForm.reset();
        }

        // --- Adicionando as fun√ß√µes ao objeto window para serem acess√≠veis pelo HTML ---
        window.selectAnswer = selectAnswer;
        window.checkFillInAnswer = checkFillInAnswer;
        window.skipQuestion = skipQuestion;
        window.nextQuestion = nextQuestion;
        window.showResult = showResult;
        window.restartQuiz = restartQuiz;
        
        // --- INICIA O FLUXO NO PRIMEIRO SPLASH SCREEN ---
        window.onload = startSplash1;
    </script>
</body>
</html>
